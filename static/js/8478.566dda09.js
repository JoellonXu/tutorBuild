(self.webpackChunktutor_jolly=self.webpackChunktutor_jolly||[]).push([[8478],{9476:function(e,t,n){"use strict";n.r(t);n(89730),n(41830),n(35082),n(59749),n(86544),n(84254),n(12826),n(77049),n(64043),n(60429),n(34338),n(34284),n(752),n(60228),n(21694),n(76265),n(78730),n(79307);var r,a=n(67294),o=n(19745),i=n(1642),l=n(73923),c=n(45879),u=n(95187),s=n(36214),m=n(8892),f=n(78589),d=n(84391),p=n(88495),y=n.n(p),g=n(45153),b=n(81418);function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w,O,j=g.ZP.div(r||(w=["\n  .account-head {\n    height: 80px;\n    line-height: 80px;\n    display: flex;\n    align-items: center;\n    .upload-btn {\n      margin: 0 20px;\n    }\n  }\n"],O||(O=w.slice(0)),r=Object.freeze(Object.defineProperties(w,{raw:{value:Object.freeze(O)}}))));t.default=function(e){var t=(new Date).getTime(),n=y()(t+"esLkEsRy"),r=window.localStorage.getItem("tutorAiManageToken")||"",p=v(o.Z.useModal(),2),g=p[0],E=p[1],w=v((0,a.useState)(),2),O=w[0],S=w[1],Z=v((0,a.useState)(1),2),k=Z[0],P=Z[1],x=v((0,a.useState)(0),2),I=x[0],_=x[1],C=v((0,a.useState)(1),2),T=C[0],N=C[1],z={name:"file",action:"https://api2.tutorjolly.com/api/manage/importStudent",headers:{authorization:"authorization-text"},data:{timestamp:(new Date).getTime(),sign:y()((new Date).getTime()+"esLkEsRy"),token:window.localStorage.getItem("tutorAiManageToken")||""},maxCount:1,onChange:function(e){if("uploading"!==e.file.status&&(e.file,e.fileList),"done"===e.file.status){if(200==e.file.response.code){var t=e.file.response;i.ZP.success("導入成功".concat(t.successCount,"條，失敗").concat(t.failInfo.length,"條"))}else i.ZP.error(e.file.response.message);P((function(e){return e+1}))}else"error"===e.file.status&&(i.ZP.error("".concat(e.file.name," file upload failed.")),P((function(e){return e+1})))}};(0,a.useEffect)((function(){(0,b.request)("api/manage/getStudentList",{method:"GET",params:{sign:n,timestamp:t,token:r,page:T,pageSize:10,class:[]}}).then((function(e){200==+e.code&&(S(e.data),_(e.total))}))}),[k,T]);var A=[{title:"賬號",dataIndex:"account",key:"account"},{title:"班級",key:"class_code",dataIndex:"class_code",render:function(e){return a.createElement(s.Z,{color:"geekblue"},e)}},{title:"學號",dataIndex:"class_num"},{title:"Level",dataIndex:"english_level",key:"english_level"},{title:"英文名",dataIndex:"name_en",key:"name_en"},{title:"中文名",dataIndex:"name",key:"name"},{title:"學校",key:"school_name",dataIndex:"school_name",render:function(e){return a.createElement(s.Z,{color:"green"},e)}},{title:"操作",align:"center",render:function(e,o){return a.createElement("div",null,a.createElement("a",{onClick:function(){return function(e){var o={account:e.account,classNum:e.class_num,cnName:e.name,znName:e.name_en,password:""},s=g.info({title:"編輯",width:500,content:a.createElement("div",{style:{paddingRight:"20px",marginTop:"20px"}},a.createElement(l.Z,{layout:"vertical",initialValues:o,onFinish:function(a){var o={sign:n,timestamp:t,token:r,type:3,update_id:e.id,classNum:a.classNum,name:a.cnName,name_en:a.enName};a.password&&(o.password=a.password),(0,b.request)("api/manage/updateAccountInfo",{method:"POST",data:o}).then((function(e){200===e.code?(i.ZP.success("編輯成功！"),s.destroy(),P((function(e){return e+1}))):i.ZP.error(e.message)}))}},a.createElement(l.Z.Item,{label:"賬號",name:"account",rules:[{required:!0,message:"請輸入賬號!"}]},a.createElement(c.Z,{disabled:!0})),a.createElement(l.Z.Item,{label:"學號",name:"classNum",rules:[{required:!0,message:"請輸入學號!"}]},a.createElement(c.Z,null)),a.createElement(l.Z.Item,{label:"英文名",name:"znName",rules:[{required:!0,message:"請輸入英文名!"}]},a.createElement(c.Z,null)),a.createElement(l.Z.Item,{label:"中文名",name:"cnName",rules:[{required:!0,message:"請輸入中文名!"}]},a.createElement(c.Z,null)),a.createElement(l.Z.Item,{label:"重置密碼",name:"password"},a.createElement(c.Z,null)),a.createElement(l.Z.Item,null,a.createElement("div",{style:{display:"flex",justifyContent:"end"}},a.createElement(u.ZP,{type:"primary",htmlType:"submit",style:{marginRight:"20px"}},"提交"),a.createElement(u.ZP,{onClick:function(){return s.destroy()}},"取消"))))),footer:null})}(o)},style:{marginRight:"10px"}},"編輯"),a.createElement("a",{style:{marginLeft:"10px"},onClick:function(){return function(e){g.confirm({title:"刪除學生",content:a.createElement("div",{style:{fontSize:"16px"}},"確認刪除",a.createElement("span",{style:{color:"red",fontWeight:700}},e.name),"學生"),onOk:function(){(0,b.request)("api/manage/delAccount",{method:"POST",data:{sign:n,timestamp:t,token:r,type:3,del_id:e.id}}).then((function(e){200===e.code?i.ZP.success("刪除成功！"):i.ZP.error("刪除失敗！"),P((function(e){return e+1}))}))}})}(o)}},"刪除"))}}];return a.createElement(j,null,a.createElement("div",{className:"account-head"},a.createElement(m.Z,h({},z,{className:"upload-btn"}),a.createElement(u.ZP,{icon:a.createElement(d.Z,null),type:"primary"},"上傳学生表格")),a.createElement(u.ZP,{onClick:function(){var e="https://api2.tutorjolly.com/downloads/importStudentTemplate.csv?".concat((new Date).getTime()),t=document.createElement("a");t.href=e,t.download="templateStudent.csv",t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(e)}},"下載excel模板")),a.createElement(f.Z,{columns:A,dataSource:O,pagination:{total:I,current:T,pageSize:10,showSizeChanger:!1,showQuickJumper:!0,onChange:function(e){return N(e)}}}),E)}},81418:function(e,t,n){"use strict";n.r(t),n.d(t,{request:function(){return l}});n(60228),n(73964),n(69373),n(59903),n(59749),n(86544),n(79288),n(40739),n(69358),n(38077),n(81919),n(47522),n(99474),n(35082),n(84254),n(752),n(21694),n(76265);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=n(71257).Z.create({baseURL:"https://api2.tutorjolly.com/",timeout:2e5}),l=function(e,t){return new Promise((function(n){i(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({url:e},t)).then((function(e){var t=e.data;n(t)})).catch((function(e){n(e)}))}))}},96424:function(){},75381:function(){}}]);