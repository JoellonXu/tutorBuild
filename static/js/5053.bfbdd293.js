(self.webpackChunktutor_jolly=self.webpackChunktutor_jolly||[]).push([[5053],{15746:function(e,t,n){"use strict";var r=n(21584);t.Z=r.Z},71230:function(e,t,n){"use strict";var r=n(92820);t.Z=r.Z},81254:function(e,t,n){"use strict";n.r(t);n(89730),n(41830),n(35082),n(59749),n(86544),n(60228),n(84254),n(752),n(21694),n(76265),n(12826),n(77049),n(64043),n(34284);var r,a,l,o=n(67294),i=n(19745),m=n(1642),u=n(73923),c=n(45879),s=n(85492),d=n(95187),p=n(16117),f=n(71230),y=n(15746),g=n(78589),E=n(81418),Z=n(96491),b=n(45153),h=n(88495);function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,o,i=[],m=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;m=!1}else for(;!(m=(r=l.call(n)).done)&&(i.push(r.value),i.length!==t);m=!0);}catch(e){u=!0,a=e}finally{try{if(!m&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var O=b.ZP.div(r||(r=P(["\n  .upload-modal-upload {\n    .ant-upload-list-item-actions {\n      display: none;\n    }\n    /* .ant-tooltip-open:hover{\n      display: none;\n    } */\n    /* .ant-tooltip-open{\n      display: none;\n    } */\n  }\n"]))),w=b.ZP.div(a||(a=P(["\n  .header {\n    margin-bottom: 10px;\n    font-size: 18px;\n  }\n  .footer {\n    margin-bottom: 30px;\n    .delete-input {\n      width: 400px;\n    }\n  }\n"]))),_=b.ZP.div(l||(l=P([""])));t.default=function(){var e=(new Date).getTime(),t=(0,h.md5)(e+"esLkEsRy"),n=window.localStorage.getItem("tutorAiManageToken")||"",r=v((0,o.useState)([]),2),a=r[0],l=r[1],b=v((0,o.useState)(0),2),x=b[0],P=b[1],I=v((0,o.useState)(0),2),S=I[0],j=I[1],T=v((0,o.useState)(1),2),C=T[0],k=T[1],Y=v(i.Z.useModal(),2),q=Y[0],D=Y[1],N=v((0,o.useState)(!1),2),M=N[0],R=N[1],H=v((0,o.useState)(!0),2),A=H[0],L=H[1],z=v((0,o.useState)({id:0,name:""}),2),$=z[0],F=z[1];(0,o.useEffect)((function(){(0,E.request)("api/manage/getSchoolList",{method:"GET",params:{sign:t,timestamp:e,token:n,page:C,pageSize:10}}).then((function(e){200===e.code&&(l(e.data),j(e.total))}))}),[x,C]);var W=[{title:"學校名稱",dataIndex:"name",key:"name"},{title:"賬號",dataIndex:"account",key:"account"},{title:"地址",dataIndex:"addr",key:"addr"},{title:"教育階段",dataIndex:"school_level",key:"school_level",render:function(e,t){return 1===e?o.createElement("div",null,"小學"):2===e?o.createElement("div",null,"中學"):3===e?o.createElement("div",null,"高中"):void 0}},{title:"URL標識",key:"url_index",dataIndex:"url_index"},{title:"LOGO",key:"logo",dataIndex:"logo",render:function(e){return o.createElement("img",{style:{width:"50px"},src:e})}},{title:"開始時間",key:"start_time",dataIndex:"start_time",render:function(e){return Z.dayjs.unix(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"結束時間",dataIndex:"end_time",render:function(e){return Z.dayjs.unix(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"操作",align:"center",render:function(r,a){return o.createElement("div",null,o.createElement("a",{onClick:function(){return function(r){var a="",l={school:r.name,account:r.account,adress:r.addr,password:"",urlPrefix:r.url_index,logo:"",ocrNum:r.ocr_num,studentOcrNum:r.student_ocr_num,endTime:Z.dayjs.unix(r.end_time),startTime:Z.dayjs.unix(r.start_time)},i=q.info({title:"修改學校信息",content:o.createElement("div",{style:{padding:"10px 30px 0 0"}},o.createElement(u.Z,{layout:"vertical",onFinish:function(l){if(l.startTime.unix()>l.endTime.unix())m.ZP.error("結束時間不能小於開始時間！");else{var o=new FormData;o.append("timestamp",e),o.append("sign",t),o.append("token",n),o.append("update_id",r.id),o.append("addr",l.adress||""),o.append("name",l.school),o.append("type",1),o.append("start_time",l.startTime.unix()),o.append("end_time",l.endTime.unix()),o.append("ocr_num",l.ocrNum),o.append("student_ocr_num",l.studentOcrNum),""!==a&&o.append("logo",a),l.password&&o.append("password",l.password),l.schoolType&&o.append("school_level",l.schoolType),(0,E.request)("api/manage/updateAccountInfo",{method:"POST",data:o}).then((function(e){200===e.code?(m.ZP.success("修改成功！"),i.destroy(),P((function(e){return e+1}))):m.ZP.error(e.message)}))}},initialValues:l},o.createElement(u.Z.Item,{label:"學校:",name:"school",rules:[{required:!0,message:"請輸入學校名稱!"}]},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:"地址:",name:"adress"},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:"學校類型:",name:"schoolType"},o.createElement(p.ZP.Group,null,o.createElement(p.ZP,{value:1},"小學"),o.createElement(p.ZP,{value:2},"初中"),o.createElement(p.ZP,{value:3},"高中"))),o.createElement(u.Z.Item,{label:"賬戶:",name:"account",rules:[{required:!0,message:"請輸入賬號!"}]},o.createElement(c.Z,{disabled:!0})),o.createElement(u.Z.Item,{label:"重置密碼:",name:"password"},o.createElement(c.Z.Password,null)),o.createElement(u.Z.Item,{label:"url標識:",name:"urlPrefix",rules:[{required:!0,message:"請輸入url標識!"}]},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:"開始時間:",name:"startTime",rules:[{required:!0,message:"請輸入開始時間!"}]},o.createElement(s.Z,{format:"YYYY-MM-DD HH:mm",showTime:!0})),o.createElement(u.Z.Item,{label:"結束時間:",name:"endTime",rules:[{required:!0,message:"請輸入結束時間!"}]},o.createElement(s.Z,{format:"YYYY-MM-DD HH:mm",showTime:!0})),o.createElement(u.Z.Item,{label:o.createElement("div",null,"老師OCR次數:",o.createElement("span",{style:{marginLeft:"250px",color:"red",fontWeight:700}},"剩餘次數: ",r.teacher_balance_ocr_num)),name:"ocrNum",rules:[{required:!0,message:"請輸入老師OCR次數!"},{pattern:/^[1-9]\d*$/,message:"請輸入正整數!"}]},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:o.createElement("div",null,"學生OCR次數:",o.createElement("span",{style:{marginLeft:"250px",color:"red",fontWeight:700}},"剩餘次數: ",r.student_balance_ocr_num)),name:"studentOcrNum",rules:[{required:!0,message:"請輸入學生OCR次數!"},{pattern:/^[1-9]\d*$/,message:"請輸入正整數!"}]},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:"重置logo:",name:"logo"},o.createElement(c.Z,{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0];a=t}})),o.createElement(u.Z.Item,null,o.createElement("div",{style:{display:"flex",justifyContent:"end"}},o.createElement(d.ZP,{type:"primary",htmlType:"submit",style:{marginRight:"20px"}},"提交"),o.createElement(d.ZP,{onClick:function(){return i.destroy()}},"取消"))))),width:600,footer:null})}(a)},style:{marginRight:"10px"}},"編輯"),o.createElement("a",{style:{marginLeft:"10px"},onClick:function(){return function(e){F(e),R(!0)}(a)}},"刪除"))}}];return o.createElement(_,null,o.createElement(f.Z,null,o.createElement(y.Z,{span:2},o.createElement(d.ZP,{onClick:function(){var r="",a=q.info({title:"上傳學校信息",content:o.createElement(O,{style:{padding:"10px 30px 0 0"}},o.createElement(u.Z,{layout:"vertical",onFinish:function(l){if(""!==r)if(l.endTime.unix()<l.startTime.unix())m.ZP.error("結束時間不能小於開始時間！");else{var o=new FormData;o.append("timestamp",e),o.append("sign",t),o.append("token",n),o.append("school_name",l.school),o.append("logo",r),o.append("url_index",l.urlPrefix),o.append("school_addr",l.adress||""),o.append("account",l.account),o.append("password",l.password),o.append("start_time",l.startTime.unix()),o.append("end_time",l.endTime.unix()),o.append("ocr_num",l.ocrNum),o.append("student_ocr_num",l.studentOcrNum),(0,E.request)("api/manage/createSchool",{method:"POST",data:o}).then((function(e){200===e.code?(m.ZP.success("創建成功"),P((function(e){return e+1}))):m.ZP.error(e.message),a.destroy()}))}else m.ZP.error("請上傳logo！")}},o.createElement(u.Z.Item,{label:"學校:",name:"school",rules:[{required:!0,message:"請輸入學校名稱!"}]},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:"地址:",name:"adress"},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:"賬戶:",name:"account",rules:[{required:!0,message:"請輸入賬號!"}]},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:"密碼:",name:"password",rules:[{required:!0,message:"請輸入密碼!"}]},o.createElement(c.Z.Password,null)),o.createElement(u.Z.Item,{label:"url標識:",name:"urlPrefix",rules:[{required:!0,message:"請輸入url標識!"}]},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:"開始時間:",name:"startTime",rules:[{required:!0,message:"請輸入開始時間!"}]},o.createElement(s.Z,{format:"YYYY-MM-DD HH:mm",showTime:!0})),o.createElement(u.Z.Item,{label:"結束時間:",name:"endTime",rules:[{required:!0,message:"請輸入結束時間!"}]},o.createElement(s.Z,{format:"YYYY-MM-DD HH:mm",showTime:!0})),o.createElement(u.Z.Item,{label:"老師OCR次數:",name:"ocrNum",rules:[{required:!0,message:"請輸入老師OCR次數!"},{pattern:/^[1-9]\d*$/,message:"請輸入正整數!"}]},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:"學生OCR次數:",name:"studentOcrNum",rules:[{required:!0,message:"請輸入學生OCR次數!"},{pattern:/^[1-9]\d*$/,message:"請輸入正整數!"}]},o.createElement(c.Z,null)),o.createElement(u.Z.Item,{label:"logo:",name:"logo",rules:[{required:!0,message:"請上傳logo!"}]},o.createElement(c.Z,{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0];r=t}})),o.createElement(u.Z.Item,null,o.createElement("div",{style:{display:"flex",justifyContent:"end"}},o.createElement(d.ZP,{type:"primary",htmlType:"submit",style:{marginRight:"20px"}},"提交"),o.createElement(d.ZP,{onClick:function(){a.destroy()}},"取消"))))),width:600,footer:null})}},"上傳學校信息"))),o.createElement(f.Z,null,o.createElement(y.Z,{span:24},o.createElement(g.Z,{columns:W,dataSource:a,pagination:{total:S,current:C,pageSize:10,showSizeChanger:!1,showQuickJumper:!0,onChange:function(e){return k(e)}}}))),o.createElement(i.Z,{open:M,footer:null,onCancel:function(){return R(!1)},destroyOnClose:!0},o.createElement(w,null,o.createElement("div",{className:"header"},"確認刪除",o.createElement("span",{style:{color:"red",fontWeight:700}},$.name),"學校?"),o.createElement("div",{className:"header"},"刪除後，學校旗下的admin、所有老師、所有學生的數據信息也會永久刪除，無法恢復，請慎重，謝謝。"),o.createElement("div",{className:"header"},"請在下方輸入",o.createElement("span",{style:{color:"#053b50",fontWeight:700}},"delete"),"刪除"),o.createElement("div",{className:"footer"},o.createElement(c.Z,{className:"delete-input",onChange:function(e){var t=e.target.value;L("delete"!==t)}})),o.createElement("div",{style:{textAlign:"right"}},o.createElement(d.ZP,{type:"primary",style:{marginRight:"20px"},disabled:A,onClick:function(){(0,E.request)("api/manage/delAccount",{method:"POST",data:{sign:t,timestamp:e,token:n,type:1,del_id:$.id}}).then((function(e){200===e.code?m.ZP.success("刪除成功！"):m.ZP.error("刪除失敗！"),R(!1),P((function(e){return e+1}))}))}},"確認刪除"),o.createElement(d.ZP,{onClick:function(){return R(!1)}},"取消")))),D)}},81418:function(e,t,n){"use strict";n.r(t),n.d(t,{request:function(){return i}});n(60228),n(73964),n(69373),n(59903),n(59749),n(86544),n(79288),n(40739),n(69358),n(38077),n(81919),n(47522),n(99474),n(35082),n(84254),n(752),n(21694),n(76265);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=n(71257).Z.create({baseURL:"https://api2.tutorjolly.com/",timeout:2e5}),i=function(e,t){return new Promise((function(n){o(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({url:e},t)).then((function(e){var t=e.data;n(t)})).catch((function(e){n(e)}))}))}},96424:function(){},75381:function(){}}]);